
### 테스트를 하는 이유

고객이 요구하는 요구 사항에 맞게 기능이 정상적으로 동작하도록 하기 위함이며 이슈에 대해 예측, 버그를 빠르게 발견하거나 코드간의 의존성을 낮춤으로서 유지 보수를 용이하게 한다. 테스트를 하면서 리팩토링도 함께 병행이 되면 코드의 품질도 향상된다.

### 좋은 테스트란?
좋은 테스트는 애플리케이션의 안정성과 코드의 품질을 향상시킨다.

- 모든 테스트는 독립적으로 실행되어야 한다.
- 테스트의 결과는 일관성이 있어야 한다.
- 내부 구현에 종속된 테스트는 지양한다.
- 테스트는 단순하고 이해하기 쉬워야 한다
- 유지 보수가 가능한 테스트를 작성해야 한다.

### Trade-Off
테스트 코드를 작성하는 것은 큰 비용이 들어가며 지속적으로 유지 보수해야 하므로 모든 코드를 검증하려면 엄청난 비용이 들 것이며, 테스트의 실행 시간도 증가할 것이다.

100% 테스트 커버리지를 목표로 하는 것이 아니라 애플리케이션의 문맥 안에서 검증해야하는 것이 무엇인지를 근본적으로 생각해야 한다.

### TDD와 Trad-Off
TDD(Test Driven Development)는 테스트 주도 개발을 의미한다. 개발 코드를 작성하기 전 테스트 코드를 먼저 작성하고 지속적인 리팩토링을 통해 테스트가 검증되는 과정을 반복하며 개발하는 방법론이다. TDD에서 개발의 시작과 끝은 테스트이다.

TDD 역시 검증해야 하는 것이 무엇인지 고민하지 않고 달려든다면 앞서 Trade Off에서 살펴본 문제점들이 고스란히 나타난다. 맹목적으로 TDD를 적용하는 것은 결과적으로 개발 생상성을 저하시키고, 시간 낭비가 될 수 있다. 하지만 테스트 대상과 범위 등 여기서 검증해야 하는 것이 무엇인지 고민하고 적절한 단위로 나누어 테스트를 실행한다면 TDD는 굉장히 큰 효과를 가진다.

### 테스트의 종류
프론트엔드에서의 테스트는 크게 `단위 테스트`, `통합 테스트`, `E2E 테스트` 그리고 `시각적 회귀 테스트`로 나눌 수 있다. 

- 단위 테스트
    - 단위 테스트는 가장 기본적인 테스트로, 단일 함수의 결과값 또는 클래스나 컴포넌트의 상태나 행위를 검증
    - 요소의 동작을 `독립적`으로 검증
    - 각각의 요소가 올바르게 동작하는지 검증되어야 `통합 테스트`, `E2E 테스트`에서 단위 테스트들의 검증 결과를 믿고, 더 큰 범주의 테스트를 수행할 수 있다.
    - 외부에서 public한 메서드들을 호출하여 어떠한 결과를 받거나 상태를 변경하기 때문에 모든 메서드를 다 검증하기보다는 인터페이스로 노출되는 public한 메서드들에 대해서만 테스트를 작성하는 것이 좋다.  
- 통합 테스트
    - 통합 테스트는 일부 개별 요소들이 조합되었을 때 올바르게 동작하는지 확인한다.
    - 단위 테스트에 비해 테스트의 사전 환경 설정이 복잡할 수 있으며 `모킹`이 필요할 수 있음
    - 통합 테스트의 효과를 얻기 위해서는 최대한 적게 `모킹`하는 것이 좋음
    - 통합 테스트를 통해 얻고자하는 것은 `어떠한 행위에 의해 모든 컴포넌트(요소)의 상태가 올바르게 변경되는가`이다. 
- E2E 테스트
    - E2E 테스트는 End-To-End 테스트의 줄임말로 말 그대로 실제 애플리케이션을 실행하여 전체 워크 플로우를 검증하는 테스트
    - E2E 테스트의 핵심은 애플리케이션을 진짜 사용자가 사용하는 것처럼 시나리오를 작성하여 검증하는 것


### 테스트 피라미드
<img src="https://velog.velcdn.com/post-images%2Fleejh3224%2F0fe256b0-3a5a-11e9-a0da-cd9277679c4b%2F-2019-02-27-3.36.22.png"/>

[이미지 출처](https://velog.velcdn.com/post-images%2Fleejh3224%2F0fe256b0-3a5a-11e9-a0da-cd9277679c4b%2F-2019-02-27-3.36.22.png)

피라미드의 위로 올라갈수록 실행되는 코드가 늘어나고 테스트 사전 환경 설정도 복잡해지기 때문에 테스트의 비용이 증가하고 실행 속도도 느려진다.
그렇다면 상대적으로 비용이 적고 실행 속도가 빠른 단위 테스트만 작성해야 되는 것일까? 피라미드 하위 테스트에서는 검증이 불가능한 것들이 있는데 단위 테스트는 요소들이 조합되었을 때 적절하게 변경되는지, 종속성이 있는 경우 이를 잘 호출하여 동자갛는지 확인할 수 없다.

테스트 피라미드를 볼 수 있듯이 테스트를 작성하는 것은 결국 Trade-Off이다. 각각의 테스트에 들어가는 비용이 다르고 테스트를 작성하면서 얻을 수 있는 효과와 신뢰성 등을 따져 보고 어떤 것이 Tade Off를 최소화할 수 있는 것인지 균형을 찾아야 한다.
